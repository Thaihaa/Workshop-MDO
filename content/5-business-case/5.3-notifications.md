---
title: "5.3. Troubleshooting thực tế"
date: 2023-07-12T11:02:05+06:00
weight: 53
chapter: false
---

## Troubleshooting thực tế

Hướng dẫn chi tiết cách xử lý các lỗi thường gặp trong quá trình triển khai hệ thống microservices và thực hiện rollback khi cần thiết.

### Bước 1: Xử lý lỗi Lambda Function

Kiểm tra logs của Lambda function bị lỗi:

```bash
# Kiểm tra Logs của Lambda function bị lỗi
aws logs describe-log-streams --log-group-name /aws/lambda/deployment-initializer

# Xem Logs chi tiết
aws logs get-log-events \
  --log-group-name /aws/lambda/deployment-initializer \
  --log-stream-name <log-stream-name>
```

### Bước 2: Debug Step Functions Execution

Thực hiện debug thông qua AWS Console:

1. **Mở AWS Step Functions Console**
2. **Tìm execution bị lỗi**
3. **Click vào state bị lỗi**
4. **Xem error details và input/output data**
5. **Kiểm tra CloudWatch logs của Lambda function được gọi**

### Bước 3: Rollback Deployment

Thực hiện rollback khi deployment thất bại:

```bash
# Trigger rollback nếu cần
python src/deployment_orchestrator.py rollback --execution-id <execution-id>

# Hoặc rollback thủ công
aws stepfunctions start-execution \
  --state-machine-arn arn:aws:states:us-east-1:424470772957:stateMachine:restaurant-deployment-orchestrator2 \
  --input '{"action": "rollback", "execution_id": "<execution-id>"}'
```

### Lưu ý quan trọng

- Luôn backup dữ liệu trước khi thực hiện rollback
- Kiểm tra logs chi tiết để xác định nguyên nhân lỗi
- Test rollback procedure trong môi trường staging trước
- Ghi lại các bước troubleshooting để tham khảo sau này 